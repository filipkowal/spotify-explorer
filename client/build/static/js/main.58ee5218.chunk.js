(this["webpackJsonpspotify-explorer-client"]=this["webpackJsonpspotify-explorer-client"]||[]).push([[0],{16:function(e,t,n){},17:function(e,t,n){},18:function(e,t,n){},21:function(e,t,n){},22:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n(1),a=n.n(r),s=n(9),o=n.n(s),i=(n(16),n(2)),u=(n(17),n(18),n(3)),l=n(4),f=n.n(l),h=n(5),j="http://localhost:5000",d=[];function b(e){return p.apply(this,arguments)}function p(){return(p=Object(h.a)(f.a.mark((function e(t){var n;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!d.includes(t)){e.next=2;break}return e.abrupt("return");case 2:return d.push(t),n={headers:{Authorization:"Bearer "+localStorage.getItem("accessToken")},json:!0},e.abrupt("return",fetch(t,n).then(function(){var e=Object(h.a)(f.a.mark((function e(n){var c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.ok){e.next=10;break}if(401!==n.status&&401!==(null===(c=n.error)||void 0===c?void 0:c.status)){e.next=9;break}return e.next=4,m();case 4:if((r=e.sent).ok){e.next=7;break}throw r;case 7:return d.pop(),e.abrupt("return",b(t));case 9:throw n;case 10:return d.pop(),e.abrupt("return",n.json());case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then((function(e){return e})).catch((function(e){return console.error("Catched Error:",e),e})));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function m(){return O.apply(this,arguments)}function O(){return(O=Object(h.a)(f.a.mark((function e(){var t;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return k(),e.next=3,fetch("".concat(j,"/refresh_token?refresh_token=")+localStorage.getItem("refreshToken")).then((function(e){if(!e.ok)throw e;return e.json()})).then((function(e){return localStorage.setItem("accessToken",e.access_token),e.access_token})).catch((function(e){return e}));case 3:return t=e.sent,e.abrupt("return",t);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(){var e=window.location.search,t=new URLSearchParams(e),n={refresh_token:t.get("refresh_token"),access_token:t.get("access_token")},c=localStorage.getItem("accessToken"),r=localStorage.getItem("refreshToken");""!==n.refresh_token&&n.refresh_token||""!==r&&r&&"null"!==r?(localStorage.setItem("accessToken",n.access_token||c),localStorage.setItem("refreshToken",n.refresh_token||r)):window.location.href="".concat(j,"/authorization")}function v(){return x.apply(this,arguments)}function x(){return(x=Object(h.a)(f.a.mark((function e(){return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,localStorage.clear();case 2:window.location.href="".concat(j,"/login?logout=true");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}k();var g=function(e){var t=e.setLoadedData,n=Object(r.useState)({}),a=Object(i.a)(n,2),s=a[0],o=a[1];return Object(r.useEffect)((function(){t((function(e){return[].concat(Object(u.a)(e),[{user:!1}])})),b("https://api.spotify.com/v1/me").then((function(e){return o(e)||{}})).then((function(){return t((function(e){return[].concat(Object(u.a)(e),[{user:!0}])}))}))}),[]),Object(c.jsxs)("p",{className:"user secondary",children:[Object(c.jsx)("span",{className:"username",children:s.display_name})," ",Object(c.jsx)("button",{onClick:v,children:"Logout"})]})},w=n(10),y=n.n(w);n(21);var S=Object(c.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:Object(c.jsx)("path",{d:"M7 4.5V5h1v-.5H7zm1-.01v-.5H7v.5h1zM8 11V7H7v4h1zm0-6.5v-.01H7v.01h1zM6 8h1.5V7H6v1zm0 3h3v-1H6v1zM7.5 1A6.5 6.5 0 0114 7.5h1A7.5 7.5 0 007.5 0v1zM1 7.5A6.5 6.5 0 017.5 1V0A7.5 7.5 0 000 7.5h1zM7.5 14A6.5 6.5 0 011 7.5H0A7.5 7.5 0 007.5 15v-1zm0 1A7.5 7.5 0 0015 7.5h-1A6.5 6.5 0 017.5 14v1z",fill:"currentColor"})}),z=Object(c.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:Object(c.jsx)("path",{d:"M7.5 13.5l4-4m-4 4l-4-4m4 4V1",stroke:"currentColor"})}),T=Object(c.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:Object(c.jsx)("path",{d:"M7.5 13.5l-.354.354a.5.5 0 00.708 0L7.5 13.5zM1.536 7.536l-.354.353.354-.353zm5-5l-.354.353.354-.353zM7.5 3.5l-.354.354a.5.5 0 00.708 0L7.5 3.5zm.964-.964l-.353-.354.353.354zm-.61 10.61L1.889 7.182l-.707.707 5.964 5.965.708-.708zm5.257-5.964l-5.965 5.964.708.708 5.964-5.965-.707-.707zM6.182 2.889l.964.965.708-.708-.965-.964-.707.707zm1.672.965l.964-.965-.707-.707-.965.964.708.708zM10.964 1c-1.07 0-2.096.425-2.853 1.182l.707.707A3.037 3.037 0 0110.964 2V1zM14 5.036c0 .805-.32 1.577-.89 2.146l.708.707A4.036 4.036 0 0015 5.036h-1zm1 0A4.036 4.036 0 0010.964 1v1A3.036 3.036 0 0114 5.036h1zM4.036 2c.805 0 1.577.32 2.146.89l.707-.708A4.036 4.036 0 004.036 1v1zM1 5.036A3.036 3.036 0 014.036 2V1A4.036 4.036 0 000 5.036h1zm.89 2.146A3.035 3.035 0 011 5.036H0c0 1.07.425 2.096 1.182 2.853l.707-.707z",fill:"currentColor"})}),A=Object(c.jsx)("svg",{viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",width:"15",height:"15",children:Object(c.jsx)("path",{d:"M4.036 1a4.036 4.036 0 00-2.854 6.89l5.964 5.964a.5.5 0 00.708 0l5.964-5.965a4.036 4.036 0 00-5.707-5.707l-.611.61-.61-.61A4.036 4.036 0 004.035 1z",fill:"currentColor"})});function M(){return(M=Object(h.a)(f.a.mark((function e(t){var n,c,r;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=localStorage.getItem("accessToken"),c="https://api.spotify.com/v1/me/tracks/contains?access_token=".concat(n,"&ids=")+t,e.next=4,fetch(c).then((function(e){return e.json()}));case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var N=function(e){var t=e.id,n=Object(r.useState)(!1),a=Object(i.a)(n,2),s=a[0],o=a[1];return Object(r.useEffect)((function(){(function(e){return M.apply(this,arguments)})(t).then((function(e){return o(e[0])}))}),[]),Object(c.jsxs)("span",{className:"likeButton",onClick:function(){s?(!function(e){var t=localStorage.getItem("accessToken"),n="https://api.spotify.com/v1/me/tracks?access_token=".concat(t,"&ids=")+e;fetch(n,{method:"DELETE"})}(t),o(!1)):(!function(e){var t=localStorage.getItem("accessToken"),n="https://api.spotify.com/v1/me/tracks?access_token=".concat(t,"&ids=")+e;fetch(n,{method:"PUT"})}(t),o(!0))},children:["  "," ",s?A:T]})};var _=function(e){var t,n=e.playlist,r=e.toggleTracks,a=e.pinPlaylist,s=e.isChecked;return Object(c.jsx)("div",{children:n.tracks?Object(c.jsx)("ul",{children:null===(t=n.tracks)||void 0===t?void 0:t.map((function(e){return Object(c.jsxs)("li",{name:e.id,children:[Object(c.jsx)("input",{id:e.id,type:"checkbox",checked:s(e.id),name:e.id,onChange:function(e){r(e),a(n)}}),Object(c.jsxs)("label",{for:e.id,children:[e.artists[0].name," - ",e.name]}),Object(c.jsx)(N,{id:e.id})]},e.id)}))}):Object(c.jsx)("p",{className:"secondary",children:"The results will go here."})},n.id)};var C=function(e){var t=e.seedTracks,n=Object(r.useState)([]),a=Object(i.a)(n,2),s=a[0],o=a[1];return Object(r.useEffect)((function(){for(var e=[],n=0;n<5;n++)n<t.length?e.push("@"):e.push("O");o(e)}),[t]),Object(c.jsxs)("p",{className:"seeds",children:["Seed tracks:"," ",s.map((function(e,t){return Object(c.jsx)("span",{className:"circle",children:e},t)}))]})};var L=function(e){var t=e.text,n=e.toggle,a=Object(r.useState)(!1),s=Object(i.a)(a,2),o=s[0],u=s[1],l=Object(r.useState)(!0),f=Object(i.a)(l,2),h=f[0],j=f[1];return Object(r.useEffect)((function(){h||(console.log("toggle Modal"),u(!0),setTimeout((function(){return u(!1)}),3e3)),j(!1)}),[n]),Object(c.jsx)(c.Fragment,{children:o?Object(c.jsx)("div",{className:"modal",children:Object(c.jsxs)("div",{className:"container",children:[Object(c.jsx)("span",{className:"info-icon",children:S}),Object(c.jsx)("span",{className:"text",children:t})]})}):""})};var E=function(){return Object(c.jsxs)("button",{className:"to-results",onClick:function(){window.scrollTo(0,document.body.scrollHeight)},children:["Results ",z]})};var I=function(e){var t=e.setLoadedData,n=Object(r.useState)([]),a=Object(i.a)(n,2),s=a[0],o=a[1],l=Object(r.useState)([]),f=Object(i.a)(l,2),h=f[0],j=f[1],d=Object(r.useState)([]),p=Object(i.a)(d,2),m=p[0],O=p[1],k=Object(r.useState)([]),v=Object(i.a)(k,2),x=v[0],g=v[1],w=Object(r.useState)(!1),S=Object(i.a)(w,2),z=S[0],T=S[1],A=Object(r.useState)(!1),M=Object(i.a)(A,2),N=M[0],I=M[1];Object(r.useEffect)((function(){t((function(e){return[].concat(Object(u.a)(e),[{likedTracks:!1}])})),b("https://api.spotify.com/v1/me/tracks").then((function(e){return o(e.items)})).then((function(){t((function(e){return[].concat(Object(u.a)(e),[{likedTracks:!0}])}))}))}),[]),Object(r.useEffect)((function(){var e;0!==m.length&&(e=m,b("https://api.spotify.com/v1/recommendations?seed_tracks="+e.reduce((function(e,t,n){return 0===n?t.id:e+","+t.id}),""))).then((function(e){var t=y()();j({id:t,tracks:e.tracks}||[])}))}),[m]);var H=Object(r.useState)([]),B=Object(i.a)(H,2),V=B[0],D=B[1];function P(e){if(m.length>=5&&e.target.checked)T((function(e){return!e}));else if(m.some((function(t){return t.id===e.target.name})))O(m.filter((function(t){return t.id!==e.target.name})));else{var t=x.reduce((function(e,t){return[].concat(Object(u.a)(e),Object(u.a)(t.tracks))}),[]),n=h.tracks?h.tracks.filter((function(t){return t.id===e.target.name})):[];O([].concat(Object(u.a)(m),Object(u.a)(s.filter((function(t){return t.track.id===e.target.name})).map((function(e){return e.track}))),Object(u.a)(t.filter((function(t){return t.id===e.target.name}))),Object(u.a)(n))),I(e.target.name)}}function F(e){return m.some((function(t){return t.id===e}))}function R(e){x.some((function(t){return t.id===e.id}))||g([].concat(Object(u.a)(x),[e]))}return Object(r.useEffect)((function(){var e=x.some((function(e){return e.id===h.id}))?x:[].concat(Object(u.a)(x),[h]);D(e)}),[x,h]),Object(c.jsxs)("div",{className:"playlists",children:[Object(c.jsx)("h2",{children:"Liked tracks"}),Object(c.jsx)("p",{className:"info",children:"1. Select up to 5 tracks to get recommendations."}),Object(c.jsxs)("div",{className:"playlist-container",children:[Object(c.jsxs)("ul",{children:[Object(c.jsx)(C,{seedTracks:m}),s&&s.length?s.map((function(e){return Object(c.jsxs)("li",{children:[Object(c.jsx)("input",{id:e.track.id,type:"checkbox",checked:F(e.track.id),name:e.track.id,onChange:function(e){P(e),I(s.id)}}),Object(c.jsxs)("label",{for:e.track.id,children:[e.track.artists[0].name," - ",e.track.name]})]},e.track.id)})):Object(c.jsx)("p",{className:"secondary",children:"Your liked tracks from Spotify will appear here."})]}),N===s.id?Object(c.jsx)(E,{}):""]}),Object(c.jsx)("h2",{children:"Recommended tracks"}),Object(c.jsx)("p",{className:"info",children:"2. Select some tracks here to get more recommendations."}),V.map((function(e){return Object(c.jsxs)("div",{className:"playlist-container",children:[Object(c.jsx)(_,{playlist:e,toggleTracks:function(t){P(t),I(e.id)},pinPlaylist:R,isChecked:F},e.id),N===e.id?Object(c.jsx)(E,{}):""]})})),Object(c.jsx)(L,{toggle:z,text:"You've ran out of seed tracks."})]})};var H=function(){var e=Object(r.useState)([]),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(c.jsxs)("div",{className:"App",children:[n.some((function(e){return!e}))?Object(c.jsx)("p",{children:"Loading..."}):"",Object(c.jsx)(g,{setLoadedData:a}),Object(c.jsx)(I,{setLoadedData:a})]})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,23)).then((function(t){var n=t.getCLS,c=t.getFID,r=t.getFCP,a=t.getLCP,s=t.getTTFB;n(e),c(e),r(e),a(e),s(e)}))};o.a.render(Object(c.jsx)(a.a.StrictMode,{children:Object(c.jsx)(H,{})}),document.getElementById("root")),B()}},[[22,1,2]]]);
//# sourceMappingURL=main.58ee5218.chunk.js.map